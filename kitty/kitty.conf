# =============================================================================
# Kitty Configuration - Hybrid Workflow Edition
# =============================================================================
# Philosophy: Kitty tabs = "big contexts" (company, clients, infra, scratch)
#             Zellij inside = "panes and layouts"
# =============================================================================

# -----------------------------------------------------------------------------
# Font Configuration
# -----------------------------------------------------------------------------
# Primary: Cousine Nerd Font; keep Monaco italic for style, with Nerd fallbacks
font_family      Cousine Nerd Font
bold_font        Cousine Nerd Font Bold
italic_font      Monaco
bold_italic_font Monaco Bold Italic
fallback_family  Cousine Nerd Font Mono
fallback_family  JetBrainsMono Nerd Font
fallback_family  FiraCode Nerd Font Mono
fallback_family  Mononoki Nerd Font Mono
fallback_family  Mononoki
fallback_family  VictorMono Nerd Font Mono
fallback_family  Iosevka Nerd Font Mono
font_size 11.0

# Enable ligatures
disable_ligatures never

# -----------------------------------------------------------------------------
# Cursor
# -----------------------------------------------------------------------------
cursor_shape block
cursor_blink_interval 0
cursor_stop_blinking_after 0

# -----------------------------------------------------------------------------
# Mouse
# -----------------------------------------------------------------------------
copy_on_select yes
strip_trailing_spaces smart
mouse_hide_wait 2.0

# URL handling
url_style curly
open_url_with default
detect_urls yes

# -----------------------------------------------------------------------------
# Window Configuration
# -----------------------------------------------------------------------------
remember_window_size yes
initial_window_width 1400
initial_window_height 900
window_padding_width 8
window_margin_width 0
window_border_width 1pt

# Background opacity (adjust for your preference)
background_opacity 0.75
dynamic_background_opacity yes

# -----------------------------------------------------------------------------
# Performance & GPU
# -----------------------------------------------------------------------------
repaint_delay 7
input_delay 1
sync_to_monitor yes

# Wayland-specific optimizations
linux_display_server wayland

# GPU rendering
# Use 'kitty --debug-rendering' to check GPU usage
wayland_enable_ime no

# -----------------------------------------------------------------------------
# Bell
# -----------------------------------------------------------------------------
enable_audio_bell no
visual_bell_duration 0.0
window_alert_on_bell no

# -----------------------------------------------------------------------------
# Tab Bar Configuration (IMPORTANT for hybrid workflow)
# -----------------------------------------------------------------------------
tab_bar_edge top
tab_bar_style powerline
tab_powerline_style slanted
tab_bar_min_tabs 1
tab_title_template "{fmt.fg.red}{bell_symbol}{activity_symbol}{fmt.fg.tab}{index}: {title}"

# Show tab bar always (you want to see which "world" you're in)
tab_bar_min_tabs 1

# -----------------------------------------------------------------------------
# Keybindings - Tab Management (Hybrid Workflow)
# -----------------------------------------------------------------------------
# Core philosophy: Use tabs for "which world am I in?"
# Let zellij handle panes inside each world

# Tab navigation (quick switching between worlds)
map ctrl+shift+right next_tab
map ctrl+shift+left  previous_tab
map ctrl+shift+t     new_tab_with_cwd
map ctrl+shift+q     close_tab
map ctrl+shift+.     move_tab_forward
map ctrl+shift+,     move_tab_backward
map ctrl+shift+z     launch --type=tab --cwd=current --tab-title="zellij" zellij
map ctrl+shift+y     launch --type=background kitty-copy-tab-title
map ctrl+shift+r     reload_config

# Direct tab access
map ctrl+shift+1 goto_tab 1
map ctrl+shift+2 goto_tab 2
map ctrl+shift+3 goto_tab 3
map ctrl+shift+4 goto_tab 4
map ctrl+shift+5 goto_tab 5

# New tab with custom title (useful for naming contexts)
map ctrl+shift+alt+t set_tab_title

# Open new tab in home directory (for scratch work)
map ctrl+shift+h new_tab

# -----------------------------------------------------------------------------
# Keyboard Scrolling
# -----------------------------------------------------------------------------
map ctrl+shift+k scroll_line_up
map ctrl+shift+j scroll_line_down
map ctrl+shift+u scroll_page_up
map ctrl+shift+d scroll_page_down
map ctrl+shift+Home scroll_home
map ctrl+shift+End scroll_end
# Fast scroll (half page)
map ctrl+alt+k scroll_to_prompt -1  # Previous prompt
map ctrl+alt+j scroll_to_prompt 1   # Next prompt

# -----------------------------------------------------------------------------
# Window Management (minimal - let zellij handle splits)
# -----------------------------------------------------------------------------
# Disable window splits - use zellij for this, but keep tab creation handy
map ctrl+shift+enter new_tab_with_cwd
map ctrl+shift+n     no_op
map ctrl+shift+w     no_op

# But keep useful window operations
map ctrl+shift+f11   toggle_fullscreen
map ctrl+shift+u     kitten unicode_input

# -----------------------------------------------------------------------------
# Scrollback & History
# -----------------------------------------------------------------------------
scrollback_lines 10000
scrollback_pager nvim -c "set nonumber nolist showtabline=0 foldcolumn=0" -c "autocmd TermOpen * normal G" -c "silent! %s/\r//g" -c "map q :qa!<CR>" -
map ctrl+shift+h show_scrollback
map ctrl+shift+/ launch --type overlay --stdin-source=@screen_scrollback fzf --no-sort --no-mouse -i --tac
map ctrl+shift+g show_last_command_output

# -----------------------------------------------------------------------------
# Hints Mode - Keyboard Text Selection
# -----------------------------------------------------------------------------
# Select URLs
map ctrl+shift+e kitten hints --type url
# Select file paths
map ctrl+shift+p kitten hints --type path
# Select lines (great for copying output)
map ctrl+shift+l kitten hints --type line --program @
# Select words
map ctrl+shift+w kitten hints --type word --program @
# Select hash (git commits, docker ids, etc)
map ctrl+shift+x kitten hints --type hash --program @
# Select hyperlinks
map ctrl+shift+o open_url_with_hints

# Custom hints for common patterns
map ctrl+shift+i kitten hints --type regex --regex '[0-9]+\.[0-9]+\.[0-9]+\.[0-9]+' --program @  # IP addresses
map ctrl+shift+d kitten hints --type regex --regex '[a-f0-9]{7,40}' --program @  # Git commits

# -----------------------------------------------------------------------------
# Clipboard
# -----------------------------------------------------------------------------
map ctrl+shift+c copy_to_clipboard
map ctrl+shift+v paste_from_clipboard
map ctrl+shift+s paste_from_selection

# OSC 52 clipboard integration (works with remote sessions)
clipboard_control write-clipboard write-primary read-clipboard read-primary

# -----------------------------------------------------------------------------
# Miscellaneous
# -----------------------------------------------------------------------------
# Shell integration (enables features like directory tracking)
shell_integration enabled

# Confirm before closing with running programs
confirm_os_window_close 1

# Update check
update_check_interval 24

# Allow remote control (useful for automation)
allow_remote_control yes
listen_on unix:/tmp/kitty

# -----------------------------------------------------------------------------
# Catppuccin Mocha Color Scheme
# -----------------------------------------------------------------------------
foreground #cdd6f4
background #1e1e2e
selection_foreground #1e1e2e
selection_background #f5e0dc

# Cursor colors
cursor #f5e0dc
cursor_text_color #1e1e2e

# URL underline color
url_color #89b4fa

# Window border colors
active_border_color #b4befe
inactive_border_color #6c7086
bell_border_color #f9e2af

# Tab bar colors (important for "which world" visual identification)
active_tab_foreground #11111b
active_tab_background #cba6f7
inactive_tab_foreground #cdd6f4
inactive_tab_background #181825
tab_bar_background #11111b

# Color palette
# Black
color0 #45475a
color8 #585b70

# Red
color1 #f38ba8
color9 #f38ba8

# Green
color2  #a6e3a1
color10 #a6e3a1

# Yellow
color3  #f9e2af
color11 #f9e2af

# Blue
color4  #89b4fa
color12 #89b4fa

# Magenta
color5  #f5c2e7
color13 #f5c2e7

# Cyan
color6  #94e2d5
color14 #94e2d5

# White
color7  #bac2de
color15 #a6adc8
